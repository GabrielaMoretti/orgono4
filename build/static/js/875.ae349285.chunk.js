"use strict";(self.webpackChunkwhiteboard_prototipo=self.webpackChunkwhiteboard_prototipo||[]).push([[875],{758:(e,t,o)=>{o.r(t),o.d(t,{default:()=>w});var a=o(555),l=o(43),s=o(14),n=o(227),i=o(110),r=o(77),d=o(469),c=o(693),b=o(104),u=o(950),m=o(78),p=o(84),x=o(579);function h(e){let{data:t,selected:o}=e;const a=(0,l.useRef)(null),[n,i]=(0,l.useState)(t.label||"Node"),[r,d]=(0,l.useState)(!1),[c,b]=(0,l.useState)(!1),[h,g]=(0,l.useState)({x:0,y:0});function f(){n!==t.label&&t.onLabelChange&&t.onLabelChange(n),d(!1)}function y(e){switch(b(!1),e){case"format":console.log("Formato n\xe3o implementado ainda");break;case"duplicate":t.onDuplicate&&t.onDuplicate();break;case"delete":t.onDelete&&t.onDelete()}}return(0,l.useEffect)(()=>{function e(){b(!1)}return c&&setTimeout(()=>{document.addEventListener("click",e)},100),()=>{document.removeEventListener("click",e)}},[c]),(0,x.jsxs)("div",{ref:a,className:"relative rounded-xl shadow flex flex-col items-center justify-center cursor-pointer transition-all bg-white border-2 border-gray-300",style:{width:t.width||160,height:t.height||56,background:t.color||"#fff",border:t.border||"2px solid #cbd5e1"},onContextMenu:function(e){e.preventDefault(),e.stopPropagation(),g({x:e.clientX,y:e.clientY}),b(!0)},children:[(0,x.jsx)("div",{className:"text-center text-sm font-medium p-2",children:r?(0,x.jsx)("input",{className:"text-center bg-transparent border-none outline-none text-sm font-medium w-full",value:n,onChange:e=>i(e.target.value),onBlur:f,onKeyDown:function(e){"Enter"===e.key?f():"Escape"===e.key&&(i(t.label||"Node"),d(!1))},autoFocus:!0}):(0,x.jsx)("div",{className:"cursor-text px-1",onClick:e=>{e.stopPropagation(),d(!0)},children:n})}),o&&(0,x.jsx)("div",{className:"absolute bottom-0 right-0 w-3 h-3 bg-blue-500 cursor-se-resize opacity-70 hover:opacity-100",style:{borderRadius:"0 0 12px 0"}}),(0,x.jsx)(s.h7,{type:"target",position:s.yX.Top,className:"opacity-0"}),(0,x.jsx)(s.h7,{type:"source",position:s.yX.Bottom,className:"opacity-0"}),(0,x.jsx)(s.h7,{type:"target",position:s.yX.Left,className:"opacity-0"}),(0,x.jsx)(s.h7,{type:"source",position:s.yX.Right,className:"opacity-0"}),c&&(0,u.createPortal)((0,x.jsx)("div",{className:"fixed inset-0 bg-transparent z-[9999]",onClick:()=>b(!1),children:(0,x.jsxs)("div",{className:"absolute bg-white border border-gray-300 rounded-lg shadow-xl py-2 min-w-[140px] z-[10000]",style:{left:Math.min(h.x,window.innerWidth-150),top:Math.min(h.y,window.innerHeight-100)},onClick:e=>e.stopPropagation(),children:[(0,x.jsxs)("button",{className:"w-full px-4 py-2 text-left text-sm hover:bg-blue-50 flex items-center gap-2",onClick:()=>y("format"),children:[(0,x.jsx)(m.zx4,{className:"w-4 h-4"}),"Formatar"]}),(0,x.jsxs)("button",{className:"w-full px-4 py-2 text-left text-sm hover:bg-blue-50 flex items-center gap-2",onClick:()=>y("duplicate"),children:[(0,x.jsx)(p.k8e,{className:"w-4 h-4"}),"Duplicar"]}),(0,x.jsx)("hr",{className:"my-1 border-gray-200"}),(0,x.jsxs)("button",{className:"w-full px-4 py-2 text-left text-sm hover:bg-red-50 text-red-600 flex items-center gap-2",onClick:()=>y("delete"),children:[(0,x.jsx)(p.S61,{className:"w-4 h-4"}),"Excluir"]})]})}),document.body)]})}const g=function(e){let{onAddElement:t,collaborators:o,projects:a,teams:l}=e;return(0,x.jsxs)("aside",{className:"w-72 bg-white border-r border-gray-200 shadow-sm flex flex-col h-full overflow-y-auto",children:[(0,x.jsxs)("div",{className:"p-4 border-b",children:[(0,x.jsx)("h2",{className:"font-bold text-lg text-gray-800",children:"Elementos"}),(0,x.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Clique para adicionar"})]}),(0,x.jsxs)("div",{className:"flex-1 p-4 space-y-4",children:[(0,x.jsx)("button",{className:"w-full px-4 py-3 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded-lg font-medium",onClick:()=>t("rectangle"),children:"Ret\xe2ngulo"}),(0,x.jsx)("button",{className:"w-full px-4 py-3 bg-green-50 hover:bg-green-100 text-green-700 rounded-lg font-medium",onClick:()=>t("circle"),children:"C\xedrculo"}),(0,x.jsx)("button",{className:"w-full px-4 py-3 bg-yellow-50 hover:bg-yellow-100 text-yellow-700 rounded-lg font-medium",onClick:()=>t("note"),children:"Nota"}),(0,x.jsxs)("div",{className:"border-t pt-4",children:[(0,x.jsx)("h3",{className:"font-semibold text-sm text-gray-700 mb-2",children:"Colaboradores"}),o.slice(0,3).map(e=>(0,x.jsx)("button",{className:"w-full mb-2 px-3 py-2 bg-emerald-50 hover:bg-emerald-100 text-emerald-700 rounded text-sm",onClick:()=>t("collaborator",void 0,e),children:e.name},e.id))]})]})]})};var f=o(190),y=o(274);o(299);function w(e){let{whiteboardId:t,onBack:o,standalone:u=!1}=e;const{whiteboards:m,setWhiteboards:p,collaborators:w,projects:v,teams:j}=(0,f.h)(),[N,C]=(0,l.useState)([]),[k,A]=(0,l.useState)([]),[D,E]=(0,l.useState)(null),[S,z]=(0,l.useState)(!0),[L,R]=(0,l.useState)(!1),T=(0,l.useMemo)(()=>t&&m.find(e=>e.id===t)||null,[m,t]);(0,l.useEffect)(()=>{if(t&&T)C(T.nodes||[]),A(T.edges||[]);else if(!t||u){const e=[{id:"demo-e1-2",source:"demo-1",target:"demo-2",animated:!0},{id:"demo-e1-3",source:"demo-1",target:"demo-3",animated:!0}];C([{id:"demo-1",data:{label:"Diretora RH",color:"#3b82f6",border:"2px solid #1e40af",width:160,height:56},position:{x:200,y:50},type:"editable"},{id:"demo-2",data:{label:"Equipe Alpha",color:"#22c55e",border:"2px solid #16a34a",width:140,height:50},position:{x:100,y:200},type:"editable"},{id:"demo-3",data:{label:"Equipe Beta",color:"#eab308",border:"2px solid #ca8a04",width:140,height:50},position:{x:300,y:200},type:"editable"}]),A(e)}z(!1)},[t,T,u]);const F=(0,l.useMemo)(()=>({onLabelChange:(e,t)=>{C(o=>o.map(o=>o.id===e?(0,a.A)((0,a.A)({},o),{},{data:(0,a.A)((0,a.A)({},o.data),{},{label:t})}):o)),R(!0)},onFormatChange:(e,t,o)=>{C(l=>l.map(l=>l.id===e?(0,a.A)((0,a.A)({},l),{},{data:(0,a.A)((0,a.A)({},l.data),{},{[t]:o})}):l)),R(!0)},onResize:(e,t,o)=>{C(l=>l.map(l=>l.id===e?(0,a.A)((0,a.A)({},l),{},{data:(0,a.A)((0,a.A)({},l.data),{},{width:t,height:o})}):l)),R(!0)},onDuplicate:e=>{C(t=>{const o=t.find(t=>t.id===e);if(!o)return t;const l="".concat(Date.now());return[...t,(0,a.A)((0,a.A)({},o),{},{id:l,position:{x:o.position.x+40,y:o.position.y+40},data:(0,a.A)((0,a.A)({},o.data),{},{label:"".concat(o.data.label," (C\xf3pia)")})})]}),R(!0)},onDelete:e=>{C(t=>t.filter(t=>t.id!==e)),A(t=>t.filter(t=>t.source!==e&&t.target!==e)),R(!0)}}),[]),M=(0,l.useMemo)(()=>N.map(e=>(0,a.A)((0,a.A)({},e),{},{data:(0,a.A)((0,a.A)((0,a.A)({},e.data),F),{},{onLabelChange:t=>F.onLabelChange(e.id,t),onFormatChange:(t,o)=>F.onFormatChange(e.id,t,o),onResize:(t,o)=>F.onResize(e.id,t,o),onDuplicate:()=>F.onDuplicate(e.id),onDelete:()=>F.onDelete(e.id)})})),[N,F]),I=(0,l.useCallback)(e=>{A(t=>(0,s.rN)(e,t)),R(!0)},[]),B=(0,l.useCallback)(e=>{C(t=>(0,s._0)(e,t)),R(!0)},[]),O=(0,l.useCallback)(e=>{A(t=>(0,s.zW)(e,t)),R(!0)},[]),X=(0,l.useCallback)(e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},[]),P=(0,l.useCallback)(e=>{if(e.preventDefault(),!D)return;const t=e.dataTransfer.getData("element-type"),o=e.dataTransfer.getData("entity-data");if(!t)return;const a=e.target.getBoundingClientRect(),l=D.project({x:e.clientX-a.left,y:e.clientY-a.top});V(t,l,o?JSON.parse(o):void 0)},[D]),V=(0,l.useCallback)((e,t,o)=>{const l="".concat(Date.now()),s=t||{x:100+300*Math.random(),y:100+200*Math.random()};let n={width:160,height:56,border:"2px solid #cbd5e1",label:"Novo Elemento"};switch(e){case"collaborator":n=(0,a.A)((0,a.A)({},n),{},{label:(null===o||void 0===o?void 0:o.name)||"Novo Colaborador",subtitle:(null===o||void 0===o?void 0:o.role)||"Fun\xe7\xe3o",color:"#22c55e",border:"2px solid #16a34a",icon:"person",width:180,height:70,entityType:"collaborator",entityId:null===o||void 0===o?void 0:o.id});break;case"project":n=(0,a.A)((0,a.A)({},n),{},{label:(null===o||void 0===o?void 0:o.name)||"Novo Projeto",subtitle:(null===o||void 0===o?void 0:o.status)||"Status",color:"#a21caf",border:"2px solid #86198f",icon:"folder",width:170,height:65,entityType:"project",entityId:null===o||void 0===o?void 0:o.id});break;case"team":n=(0,a.A)((0,a.A)({},n),{},{label:(null===o||void 0===o?void 0:o.name)||"Nova Equipe",color:"#f59e0b",border:"2px solid #d97706",icon:"team",width:150,height:60,entityType:"team",entityId:null===o||void 0===o?void 0:o.id});break;case"rectangle":n=(0,a.A)((0,a.A)({},n),{},{label:"Ret\xe2ngulo",color:"#3b82f6",border:"2px solid #1e40af"});break;case"circle":n=(0,a.A)((0,a.A)({},n),{},{label:"C\xedrculo",color:"#22c55e",border:"2px solid #16a34a"});break;case"note":n=(0,a.A)((0,a.A)({},n),{},{label:"Nota",color:"#eab308",border:"2px solid #ca8a04",icon:"note"})}const i={id:l,type:"editable",position:s,data:n};C(e=>[...e,i]),R(!0)},[]),W=(0,l.useCallback)(()=>{t&&(p(e=>e.map(e=>e.id===t?(0,a.A)((0,a.A)({},e),{},{nodes:N,edges:k,updatedAt:new Date}):e)),R(!1))},[t,N,k,p]),q=(0,l.useCallback)(()=>{const e={id:t||"export",name:(null===T||void 0===T?void 0:T.name)||"Whiteboard Export",nodes:N,edges:k,exportedAt:(new Date).toISOString()},o=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(o),l=document.createElement("a");l.href=a,l.download="whiteboard-".concat(e.name.replace(/\s+/g,"-").toLowerCase(),".json"),l.click(),URL.revokeObjectURL(a)},[t,T,N,k]),U={editable:h};return S?(0,x.jsx)(y.k,{message:"Carregando whiteboard..."}):(0,x.jsxs)("div",{className:"flex h-[calc(100vh-2rem)] bg-gray-50",children:[(0,x.jsx)(g,{onAddElement:V,collaborators:w,projects:v,teams:j}),(0,x.jsxs)("div",{className:"flex-1 flex flex-col bg-white",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between p-4 bg-white border-b shadow-sm",children:[(0,x.jsxs)("div",{className:"flex items-center gap-4",children:[o&&(0,x.jsxs)("button",{onClick:o,className:"flex items-center gap-2 text-blue-600 hover:bg-blue-50 px-3 py-2 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-blue-400",type:"button",children:[(0,x.jsx)(d.A,{size:18})," Voltar"]}),(0,x.jsx)("h1",{className:"text-xl font-bold text-gray-800",children:(null===T||void 0===T?void 0:T.name)||"Whiteboard Demo"}),L&&(0,x.jsx)("span",{className:"text-sm text-orange-600 bg-orange-50 px-2 py-1 rounded",children:"N\xe3o salvo"})]}),(0,x.jsxs)("div",{className:"flex items-center gap-2",children:[(0,x.jsxs)("span",{className:"text-sm text-gray-600",children:[M.length," elementos"]}),t&&(0,x.jsxs)("button",{onClick:W,disabled:!L,className:"flex items-center gap-2 bg-blue-600 text-white px-3 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[(0,x.jsx)(c.A,{size:16}),"Salvar"]}),(0,x.jsxs)("button",{onClick:q,className:"flex items-center gap-2 bg-gray-600 text-white px-3 py-2 rounded-lg hover:bg-gray-700 transition-colors",children:[(0,x.jsx)(b.A,{size:16}),"Exportar"]})]})]}),(0,x.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,x.jsx)(s.Ln,{children:(0,x.jsxs)(s.Gc,{nodes:M,edges:k,onNodesChange:B,onEdgesChange:O,onConnect:I,onInit:E,onDrop:P,onDragOver:X,fitView:!0,nodeTypes:U,className:"w-full h-full",defaultViewport:{x:0,y:0,zoom:1},children:[(0,x.jsx)(n.V,{gap:20,size:1,color:"#e5e7eb"}),(0,x.jsx)(i.o,{nodeColor:()=>"#3b82f6",maskColor:"rgba(59,130,246,0.1)",className:"bg-white border rounded-lg shadow-sm",pannable:!0,zoomable:!0}),(0,x.jsx)(r.H,{className:"bg-white border rounded-lg shadow-sm",showZoom:!0,showFitView:!0,showInteractive:!0})]})})})]})]})}}}]);
//# sourceMappingURL=875.ae349285.chunk.js.map